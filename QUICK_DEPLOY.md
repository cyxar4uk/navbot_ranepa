# üöÄ –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è

## –°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± (GitHub Actions)

**‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ:** –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –¢–û–õ–¨–ö–û –≤ –ø–∞–ø–∫–µ `/www/wwwroot/testingsmth.anyway-community.ru/navbot_ranepa`. –î—Ä—É–≥–∏–µ —Å–∞–π—Ç—ã –Ω–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—é—Ç—Å—è.

### 1. –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ (—á–µ—Ä–µ–∑ aaPanel Terminal –∏–ª–∏ SSH):

```bash
# –°–æ–∑–¥–∞–π—Ç–µ SSH –∫–ª—é—á –¥–ª—è GitHub Actions (–º–æ–∂–Ω–æ –≤ –ª—é–±–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏)
ssh-keygen -t ed25519 -C "github-actions-navbot" -f ~/.ssh/github_actions_navbot -N "

# –î–æ–±–∞–≤—å—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –≤ authorized_keys
cat ~/.ssh/github_actions_navbot.pub >> ~/.ssh/authorized_keys

# –ü–æ–∫–∞–∂–∏—Ç–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á (—Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –µ–≥–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é)
cat ~/.ssh/github_actions_navbot
```

### 2. –í GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏:

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ: **Settings ‚Üí Secrets and variables ‚Üí Actions**
2. –ù–∞–∂–º–∏—Ç–µ **New repository secret**
3. –î–æ–±–∞–≤—å—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã:

| –ò–º—è | –ó–Ω–∞—á–µ–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|-----|----------|--------|
| `SERVER_HOST` | IP –∏–ª–∏ –¥–æ–º–µ–Ω —Å–µ—Ä–≤–µ—Ä–∞ | `208.92.227.20` |
| `SERVER_USER` | SSH –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å | `root` |
| `SSH_PRIVATE_KEY` | –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á (–≤–µ—Å—å —Ñ–∞–π–ª `~/.ssh/github_actions_navbot`) | `-----BEGIN OPENSSH PRIVATE KEY-----...` |
| `SSH_PORT` | –ü–æ—Ä—Ç SSH (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) | `22` |

### 3. –û—á–∏—Å—Ç–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è)

**‚ö†Ô∏è –í–∞–∂–Ω–æ:** –ï—Å–ª–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –µ—Å—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—Ç —Å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–º, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:

```bash
cd /www/wwwroot/testingsmth.anyway-community.ru/navbot_ranepa
git fetch origin
git reset --hard origin/main  # –∏–ª–∏ origin/master –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ master
git clean -fd
```

–≠—Ç–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç —Å–µ—Ä–≤–µ—Ä —Å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–º –∏ —É–¥–∞–ª–∏—Ç –ª–æ–∫–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è.

### 4. –ì–æ—Ç–æ–≤–æ! 

–¢–µ–ø–µ—Ä—å –ø—Ä–∏ –∫–∞–∂–¥–æ–º `git push` –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ–ø–ª–æ—è—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä.

### 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
cd /www/wwwroot/testingsmth.anyway-community.ru/navbot_ranepa
docker-compose ps

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
docker-compose logs backend
docker-compose logs frontend

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å API
curl http://localhost:8000/health
```

–ü–æ–¥—Ä–æ–±–Ω–µ–µ —Å–º. `HEALTHCHECK.md`

---

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –†—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π —Å–∫—Ä–∏–ø—Ç

–ï—Å–ª–∏ –Ω–µ —Ö–æ—Ç–∏—Ç–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å GitHub Actions, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç:

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ —Å–¥–µ–ª–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
chmod +x /www/wwwroot/testingsmth.anyway-community.ru/navbot_ranepa/deploy.sh

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –¥–µ–ø–ª–æ–π
cd /www/wwwroot/testingsmth.anyway-community.ru/navbot_ranepa
./deploy.sh
```

–ò–ª–∏ –ø—Ä–æ—Å—Ç–æ –≤—Ä—É—á–Ω—É—é:
```bash
cd /www/wwwroot/testingsmth.anyway-community.ru/navbot_ranepa
git pull
docker-compose up -d --build
```

## –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –∑–∞–Ω—è—Ç—ã–º–∏ –ø–æ—Ä—Ç–∞–º–∏

–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ –æ—à–∏–±–∫—É `address already in use`:

### –í–∞—Ä–∏–∞–Ω—Ç 1: –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–∞–∫–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø–æ—Ä—Ç—ã
docker ps | grep -E "8000|6379|3000"

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∏—Ö
docker stop <container_id>

# –ò–ª–∏ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã (–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ!)
docker stop $(docker ps -q)
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ò–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—Ç—ã —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```bash
BACKEND_PORT=8001
FRONTEND_PORT=3001
```

–ó–∞—Ç–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç–µ:
```bash
docker-compose up -d --build
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π docker-compose —Ñ–∞–π–ª

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ `docker-compose.yml` –≤ `docker-compose.custom.yml` –∏ –∏–∑–º–µ–Ω–∏—Ç–µ –ø–æ—Ä—Ç—ã –≤—Ä—É—á–Ω—É—é.

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ GitHub Actions:

1. –°–¥–µ–ª–∞–π—Ç–µ –ª—é–±–æ–π –∫–æ–º–º–∏—Ç –∏ push:
```bash
git add .
git commit -m "Test deployment"
git push
```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –≤ GitHub: **Actions** –≤–∫–ª–∞–¥–∫–∞ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏

3. –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
```bash
docker-compose logs -f backend
```
